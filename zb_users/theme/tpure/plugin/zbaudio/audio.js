!function(x,T,S){var z={controller:".zbaudio",elem:{cover:".zbaudio_img",songTitle:".zbaudio_info strong",songSinger:".zbaudio_singer",thisTime:".zbaudio_current",countTime:".zbaudio_total",setbacks:".zbaudio_progress",thisSetbacks:".zbaudio_now",cacheSetbacks:".zbaudio_cache",audioBtn:".zbaudio_play"},song:null,error:null},k=[{type:1,meg:"\u97f3\u9891\u8def\u5f84\u4e0d\u5b58\u5728\u6216\u8005\u52a0\u8f7d\u5931\u8d25"},{type:2,meg:"\u83b7\u53d6\u4e0d\u5230\u64ad\u653e\u5668\u6216\u4e3b\u9898\u5df2\u5f00\u542f\u5185\u5bb9\u4fdd\u62a4"},{type:3,meg:"\u5f53\u524d\u6b4c\u5355\u6ca1\u6709\u6b4c\u66f2"},{type:4,meg:"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u8be5\u97f3\u9891\u683c\u5f0f"},{type:5,meg:"\u5bf9\u8c61\u7f3a\u7701src\u5c5e\u6027"}],_=new Audio,C=0;function B(t){return(100<(t*=100)?100:t<0?0:t)+"%"}function e(t){return 9<t?t:"0"+t}function X(t){return e(~~(t/60))+":"+e(~~(t%60))}x.audioPlay=function(t){var o=this;if("object"==typeof t)for(var e in t)z[e]=t[e];if(this.errors=function(t){"function"==typeof z.error&&z.error(t)},_){_.onerror=function(){o.errors(k[0])};var n,a,i,r,s,u,c,l,d,f,h,m,p=S(z.controller),g={};if(!p.length)return o.errors(k[1]);for(n in z.elem)g[n]=p.find(z.elem[n]);_.onended=function(){o.play(!1),0<_.buffered.length&&g.cacheSetbacks.css("width",0),g.thisSetbacks.css("width",0),g.thisTime.text("00:00")},i=g.setbacks,r=function(t){a=(t.x/t.maxX*100).toFixed(2),g.thisTime.text(X(~~(_.duration*a/100))),g.thisSetbacks.css("width",a+"%")},s={before:function(){o.schedule(!1)},after:function(t){var e=~~(_.duration*a/100);_.currentTime=e,o.schedule(!0)}},u="ontouchstart"in x,c=u?"touchstart":"mousedown",l=u?"touchmove":"mousemove",d=u?"touchend":"mouseup",f=S(T),h=!1,m=0,i.on(c,function(t){h=!1,m=i.width(),s&&s.before&&s.before();var e=v(t),n=b(e);function o(t){t=v(t);3<Math.abs(t-e)&&(h=!0),w(b(t))}f.on(l,o),f.on(d,function t(){f.off(l,o),f.off(d,t),h||w(n),s&&s.after&&s.after({x:n*m/100,maxX:m})}),t.preventDefault()});var y={};return g.audioBtn.find("*").each(function(){var t=S(this),e=t.data("action");e&&(y[e]=t)}),y.play.data("playStatus",!0),y.play.addClass(y.play.data("on")).removeClass(y.play.data("off")),g.audioBtn.on("click",function(t){t=S(t.target);t.data("action")&&("play"===t.data("action")?o.play(y.play.data("playStatus")):console.log("\u672a\u77e5\u64cd\u4f5c"))}),this.loadFile=function(t){if(!z.song)return o.errors(k[2]);o.play(!1);var e,n=z.song[C];return n.src?(e=n.src.substr(n.src.lastIndexOf(".")+1),_.canPlayType("audio/"+e)?(_.src=n.src,n.cover?g.cover.html('<img src="'+(n.cover||"")+'" alt="'+(n.title||n.singer)+'">'):g.cover.html('<span class="zbaudio_img"></span>'),g.songTitle.text(n.title),g.songSinger.text(n.singer),function t(){isNaN(_.duration)?setTimeout(t,80):g.countTime.text(X(_.duration))}(),void o.play(t)):o.errors(k[3])):o.errors(k[4])},this.schedule=function(t){_.ontimeupdate=t?function(){0<_.buffered.length&&g.cacheSetbacks.css("width",B(_.buffered.end(0)/_.duration)),g.thisSetbacks.css("width",B(_.currentTime/_.duration)),g.thisTime.text(X(_.currentTime))}:null},this.volume=function(t){_.volume=t||_.volume,g.volume.find(".volume-box i").css("width",B(_.volume))},this.play=function(t){_.src&&(t?(_.play(),y.play.data("playStatus",!1),y.play.addClass(y.play.data("off")).removeClass(y.play.data("on"))):(_.pause(),y.play.data("playStatus",!0),y.play.addClass(y.play.data("on")).removeClass(y.play.data("off"))),o.schedule(t))},this.switch=function(t){t?C++:C--,C=C>=z.song.length?0:C<0?z.song.length-1:C,o.loadFile(!0)},this.next=function(){o.switch(!0)},this.prev=function(){o.switch(!1)},this}function v(t){var e=t.originalEvent;return(e.changedTouches?e.changedTouches[0]:t).clientX}function b(t){var e=i[0].getBoundingClientRect(),t=t-e.left;return Math.max(0,Math.min(100,t/e.width*100))}function w(t){r&&r({x:t*i.width()/100,maxX:i.width()})}}}(window,document,jQuery);